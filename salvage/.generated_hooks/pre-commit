#!/usr/bin/env python
import sys, pathlib
root = pathlib.Path(__file__).resolve().parent.parent
report = root / 'PRECOMMIT_COMPLEXITY_REPORT.md'
if not report.exists():
    sys.exit(0)
lines = report.read_text(encoding='utf-8', errors='ignore').splitlines()
violations = [l for l in lines if l.startswith('- ')]
if violations:
    print('[pre-commit] Complexity violations detected:', len(violations))
    for v in violations[:15]:
        print('  ', v)
    print('Abort commit. Refactor or adjust thresholds.')
    sys.exit(1)
sys.exit(0)
